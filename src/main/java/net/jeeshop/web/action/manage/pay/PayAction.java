package net.jeeshop.web.action.manage.pay;import javax.servlet.http.HttpServletRequest;import net.jeeshop.core.KeyValueHelper;import net.jeeshop.core.front.SystemManager;import net.jeeshop.services.manage.pay.PayService;import net.jeeshop.services.manage.pay.bean.Pay;import net.jeeshop.web.action.BaseController;import org.apache.commons.lang.StringUtils;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.ModelAttribute;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.servlet.mvc.support.RedirectAttributes;/** * 支付方式 * @author huangf * @author dylan * */@Controller@RequestMapping("/manage/pay/")public class PayAction extends BaseController<Pay> {	private static final long serialVersionUID = 1L;	private static final Logger logger = LoggerFactory.getLogger(PayAction.class);	@Autowired	private PayService payService;	@Autowired    private SystemManager systemManager;		private static final String page_toList = "/manage/pay/payList";	private static final String page_toEdit = "/manage/pay/payEdit";	private static final String page_toAdd = "/manage/pay/payEdit";	private PayAction() {		super.page_toList = page_toList;		super.page_toAdd = page_toAdd;		super.page_toEdit = page_toEdit;	}	public PayService getService() {		return payService;	}	@Override	public String insert(HttpServletRequest request, Pay e, RedirectAttributes flushAttrs) throws Exception {		throw new RuntimeException("非法请求！");	}		//根据code获取名称	private void comm(Pay e) {		logger.error("comm..code="+e.getCode());		String name = KeyValueHelper.get("pay_code_"+e.getCode());		if(StringUtils.isBlank(name)){			throw new NullPointerException("未配置"+e.getCode()+"的支付方式的键值对！");		}				e.setName(name);	}		@Override	public String update(HttpServletRequest request, Pay e, RedirectAttributes flushAttrs) throws Exception {		comm(e);		e.setCode(Pay.pay_code_alipayescow);		String success = super.update(request, e, flushAttrs);		//更新缓存		systemManager.setAlipayConfig(e.getSeller());				return success;	}		@Override	public String deletes(HttpServletRequest request, String[] ids, @ModelAttribute("e") Pay e, RedirectAttributes flushAttrs) throws Exception {		throw new RuntimeException("非法请求！");	}}